# ğŸ”„ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ  vs é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨æ¯”è¼ƒ

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ¯”è¼ƒ](#1-ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ¯”è¼ƒ)
2. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®æ¯”è¼ƒ](#2-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®æ¯”è¼ƒ)
3. [ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•å±¥æ­´ã®æ¯”è¼ƒ](#3-ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•å±¥æ­´ã®æ¯”è¼ƒ)
4. [æ„å›³æŠ½å‡ºãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®æ¯”è¼ƒ](#4-æ„å›³æŠ½å‡ºãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®æ¯”è¼ƒ)
5. [è³ªå•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã®æ¯”è¼ƒ](#5-è³ªå•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã®æ¯”è¼ƒ)
6. [ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¯”è¼ƒ](#6-ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¯”è¼ƒ)
7. [å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã®æ¯”è¼ƒ](#7-å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã®æ¯”è¼ƒ)
8. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚³ã‚¹ãƒˆã®æ¯”è¼ƒ](#8-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚³ã‚¹ãƒˆã®æ¯”è¼ƒ)

---

# 1. ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æ¯”è¼ƒ

## 1-1. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¯”è¼ƒå›³

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚·ãƒ³ãƒ—ãƒ«å‹ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
  â†“
åŸºæœ¬æƒ…å ±å…¥åŠ›ï¼ˆè·ç¨®ã€å‹¤å‹™åœ°ã€å¹´åï¼‰
  â†“
åˆå›ãƒãƒƒãƒãƒ³ã‚°ï¼ˆ43ä»¶ï¼‰
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å›ºå®šè³ªå•ãƒªã‚¹ãƒˆã‹ã‚‰1ã¤é¸æŠ         â”‚
â”‚ - ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ï¼Ÿ               â”‚
â”‚ - ä¼æ¥­è¦æ¨¡ï¼Ÿ                     â”‚
â”‚ - ç ”ä¿®åˆ¶åº¦ï¼Ÿ                     â”‚
â”‚ â€»é †ç•ªã¯å›ºå®š                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
YES/NO ã§å›ç­”
  â†“
æ±‚äººã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆ43â†’21â†’13â†’3ä»¶ï¼‰
  â†“
3ä»¶ä»¥ä¸‹ã«ãªã£ãŸã‚‰çµ‚äº†
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ€çµ‚æ¨è–¦ï¼ˆå˜ç´”ãªãƒ­ã‚¸ãƒƒã‚¯ï¼‰        â”‚
â”‚ 1. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¸ˆã¿ï¼ˆ2ä»¶ï¼‰      â”‚
â”‚ 2. ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°æ¤œç´¢ï¼ˆ2ä»¶ï¼‰      â”‚
â”‚ 3. é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ1ä»¶ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
çµ‚äº†ï¼ˆæ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ãƒªã‚»ãƒƒãƒˆï¼‰
```

### é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆAIå­¦ç¿’å‹ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
  â†“
åŸºæœ¬æƒ…å ±å…¥åŠ›ï¼ˆè·ç¨®ã€å‹¤å‹™åœ°ã€å¹´åï¼‰
  â†“
åˆå›ãƒãƒƒãƒãƒ³ã‚°ï¼ˆ43ä»¶ï¼‰
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AIãŒå‹•çš„ã«è³ªå•ã‚’ç”Ÿæˆ              â”‚
â”‚ - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ        â”‚
â”‚ - éå»ã®ä¼šè©±å±¥æ­´å‚ç…§             â”‚
â”‚ - ç¾åœ¨ã®æ±‚äººåˆ†å¸ƒã‚’è€ƒæ…®           â”‚
â”‚ - æœ€é©ãªè³ªå•ã‚’é¸æŠ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
è‡ªç„¶è¨€èªã§å›ç­”
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AIãŒå›ç­”ã‚’æ·±ãåˆ†æ                â”‚
â”‚ - æ˜ç¤ºçš„ãªæ¡ä»¶æŠ½å‡º               â”‚
â”‚ - æš—é»™çš„ãªä¾¡å€¤è¦³æ¨å®š             â”‚
â”‚ - æ„Ÿæƒ…ãƒ»æ…‹åº¦ã®ç†è§£               â”‚
â”‚ - ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—è³ªå•ç”Ÿæˆ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
è¤‡æ•°ã®æƒ…å ±æºã«ä¿å­˜
  â”œâ†’ å›ºå®šã‚«ãƒ©ãƒ ï¼ˆé«˜é€Ÿæ¤œç´¢ç”¨ï¼‰
  â”œâ†’ JSONBï¼ˆæŸ”è»Ÿãƒ‡ãƒ¼ã‚¿ï¼‰
  â”œâ†’ å®Œå…¨ãƒ†ã‚­ã‚¹ãƒˆï¼ˆå†è§£æç”¨ï¼‰
  â””â†’ ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆæ„å‘³æ¤œç´¢ç”¨ï¼‰
  â†“
æ±‚äººã‚’å¤šè§’çš„ã«ãƒãƒƒãƒãƒ³ã‚°
  â”œâ†’ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  â”œâ†’ ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°é¡ä¼¼åº¦
  â”œâ†’ å”èª¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  â””â†’ AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¶™ç¶šçš„ãªå­¦ç¿’ãƒ»æ”¹å–„                â”‚
â”‚ - å¿œå‹Ÿç‡ã‚’è¿½è·¡                   â”‚
â”‚ - è³ªå•ã®åŠ¹æœæ¸¬å®š                 â”‚
â”‚ - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—åˆ†é¡             â”‚
â”‚ - æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§æ´»ç”¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
æ¬¡å›ã¯ã•ã‚‰ã«è³¢ããªã‚‹
```

---

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®æ¯”è¼ƒ

## 2-1. ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆã®æ¯”è¼ƒ

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®DB

```sql
-- ============================================
-- æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ12ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
-- ============================================

1. personal_date
   - user_id, email, password_hash, user_name
   
2. user_profile
   - user_id, job_title, location_prefecture, salary_min
   - conversation_embedding (VECTOR)
   
3. chat_history
   - user_id, sender, message, session_id, created_at
   
4. user_question_responses
   - user_id, question_key, response_text, normalized_response
   
5. user_interactions
   - user_id, job_id, interaction_type, created_at
   
6. company_date
   - company_id, company_name
   
7. company_profile
   - id, company_id, job_title, location_prefecture
   - salary_min, salary_max, embedding
   
8. user_conversation_embeddings
   - user_id, session_id, embedding

â€» ãã®ä»–ç®¡ç†ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«çœç•¥

ã€ç‰¹å¾´ã€‘
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âœ… ç†è§£ã—ã‚„ã™ã„
âŒ æ‹¡å¼µæ€§ä½ã„
âŒ æŸ”è»Ÿæ€§ä¸è¶³
âŒ ãƒ‡ãƒ¼ã‚¿é›†ç´„ãªã—ï¼ˆæ°¸é ã«å¢—ãˆç¶šã‘ã‚‹ï¼‰
```

### é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã®DB

```sql
-- ============================================
-- é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ—¢å­˜12 + æ–°è¦6ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
-- ============================================

ã€æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ« - ãã®ã¾ã¾ä½¿ç”¨ã€‘
1. personal_date
2. user_profile (æ‹¡å¼µç‰ˆ)
3. chat_history
4. user_question_responses (æ‹¡å¼µç‰ˆ)
5. user_interactions
6. company_date
7. company_profile

ã€æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ« - è¿½åŠ ã€‘
8. user_dynamic_profile â­
   -- æŸ”è»Ÿãªéæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿
   - user_id, profile_data (JSONB)
   
9. extracted_insights â­
   -- AIãŒæŠ½å‡ºã—ãŸæƒ…å ±
   - user_id, insights (JSONB), confidence_score
   
10. user_embedding_history â­
    -- ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ã®æ™‚ç³»åˆ—å¤‰åŒ–
    - user_id, embedding, created_at
    
11. user_interaction_monthly_summary â­
    -- æœˆæ¬¡é›†ç´„ãƒ‡ãƒ¼ã‚¿
    - user_id, month, click_rate, apply_rate, etc.
    
12. user_interaction_yearly_summary â­
    -- å¹´æ¬¡é›†ç´„ãƒ‡ãƒ¼ã‚¿
    - user_id, year, success_rate, etc.
    
13. user_deep_profile â­
    -- æ·±å±¤ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    - career_goal, decision_style, priorities

ã€ç‰¹å¾´ã€‘
âœ… æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨äº’æ›æ€§ã‚ã‚Š
âœ… æ®µéšçš„ã«å°å…¥å¯èƒ½
âœ… ç„¡é™ã®æ‹¡å¼µæ€§
âœ… ãƒ‡ãƒ¼ã‚¿é›†ç´„ã§æŒç¶šå¯èƒ½
âœ… AIå­¦ç¿’ã«æœ€é©åŒ–
```

---

## 2-2. ãƒ‡ãƒ¼ã‚¿å®¹é‡ã®æ¯”è¼ƒï¼ˆ1å¹´å¾Œï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     1å¹´å¾Œã®ãƒ‡ãƒ¼ã‚¿é‡äºˆæ¸¬                    â”‚
â”‚     (ãƒ¦ãƒ¼ã‚¶ãƒ¼10,000äººã€æ±‚äºº5,000ä»¶)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã€‘
user_interactions: 30,000,000ä»¶ (30GB)
chat_history: 500,000ä»¶ (5GB)
user_question_responses: 100,000ä»¶ (1GB)
åˆè¨ˆ: ç´„36GB

å•é¡Œ:
âŒ ãƒ‡ãƒ¼ã‚¿ãŒæ°¸é ã«å¢—ãˆç¶šã‘ã‚‹
âŒ ã‚¯ã‚¨ãƒªãŒå¾ã€…ã«é…ããªã‚‹
âŒ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆå¢—å¤§

ã€é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã€‘
user_interactions (90æ—¥åˆ†): 2,500,000ä»¶ (2.5GB)
monthly_summary: 120,000ä»¶ (0.1GB)
yearly_summary: 10,000ä»¶ (0.01GB)
chat_history (30æ—¥åˆ†): 50,000ä»¶ (0.5GB)
extracted_insights: 200,000ä»¶ (2GB)
user_dynamic_profile: 10,000ä»¶ (0.5GB)
åˆè¨ˆ: ç´„5.6GB

åŠ¹æœ:
âœ… 84%å‰Šæ¸›ï¼ˆ36GB â†’ 5.6GBï¼‰
âœ… ã‚¯ã‚¨ãƒªé€Ÿåº¦ç¶­æŒ
âœ… ã‚³ã‚¹ãƒˆå‰Šæ¸›
âœ… é›†ç´„ãƒ‡ãƒ¼ã‚¿ã§åˆ†æå¯èƒ½
```

---

# 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•å±¥æ­´ã®æ¯”è¼ƒ

## 3-1. ä¿å­˜ã•ã‚Œã‚‹æƒ…å ±ã®é•ã„

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ 

```sql
-- user_interactions ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE user_interactions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    job_id TEXT,
    interaction_type VARCHAR(50),  -- click, view, favorite, apply
    created_at TIMESTAMP
);

-- ä¿å­˜ã•ã‚Œã‚‹æƒ…å ±ï¼ˆä¾‹ï¼‰
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ user_id â”‚ job_id â”‚ type    â”‚ created_at   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 4001    â”‚ abc123 â”‚ click   â”‚ 2025-01-01   â”‚
â”‚ 2  â”‚ 4001    â”‚ abc123 â”‚ view    â”‚ 2025-01-01   â”‚
â”‚ 3  â”‚ 4001    â”‚ abc123 â”‚ favoriteâ”‚ 2025-01-02   â”‚
â”‚ 4  â”‚ 4001    â”‚ abc123 â”‚ apply   â”‚ 2025-01-05   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€ç‰¹å¾´ã€‘
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âœ… å®Ÿè£…ãŒç°¡å˜
âŒ è©³ç´°æƒ…å ±ãªã—
âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æå›°é›£
âŒ æ°¸é ã«è“„ç©

ã€æ´»ç”¨æ–¹æ³•ã€‘
- é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ï¼ˆå…±é€šã®æ±‚äººï¼‰
- å¿œå‹Ÿç‡è¨ˆç®—ï¼ˆapply / totalï¼‰
```

---

### é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ 

```sql
-- user_interactionsï¼ˆæ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ« - 90æ—¥åˆ†ã®ã¿ï¼‰
-- + monthly_summaryï¼ˆæœˆæ¬¡é›†ç´„ï¼‰
-- + yearly_summaryï¼ˆå¹´æ¬¡é›†ç´„ï¼‰

-- æœˆæ¬¡é›†ç´„ã®ä¾‹
CREATE TABLE user_interaction_monthly_summary (
    user_id INTEGER,
    month DATE,
    
    -- åŸºæœ¬çµ±è¨ˆ
    total_interactions INTEGER,
    unique_jobs_viewed INTEGER,
    
    -- è¡Œå‹•ã‚¿ã‚¤ãƒ—åˆ¥
    click_count INTEGER,
    view_count INTEGER,
    favorite_count INTEGER,
    apply_count INTEGER,
    
    -- ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ â­
    click_rate DECIMAL(5,2),      -- 30.5%
    view_rate DECIMAL(5,2),       -- 25.0%
    favorite_rate DECIMAL(5,2),   -- 15.0%
    apply_rate DECIMAL(5,2),      -- 5.5%
    
    -- ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ â­
    view_to_apply_rate DECIMAL(5,2),     -- 20%
    favorite_to_apply_rate DECIMAL(5,2), -- 40%
    
    -- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‰¹æ€§ â­
    avg_time_to_apply_days DECIMAL(10,2),  -- 7.5æ—¥
    most_interested_job_category VARCHAR(100),
    
    PRIMARY KEY (user_id, month)
);

-- ä¿å­˜ã•ã‚Œã‚‹æƒ…å ±ï¼ˆä¾‹ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ user_id â”‚ month  â”‚ total â”‚ appliesâ”‚ apply_% â”‚ category â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4001    â”‚ 2025-01â”‚ 150   â”‚ 8      â”‚ 5.3%    â”‚ Designer â”‚
â”‚ 4001    â”‚ 2025-02â”‚ 180   â”‚ 12     â”‚ 6.7%    â”‚ Designer â”‚
â”‚ 4001    â”‚ 2025-03â”‚ 200   â”‚ 20     â”‚ 10.0%   â”‚ Frontend â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€ç‰¹å¾´ã€‘
âœ… è©³ç´°ãªçµ±è¨ˆæƒ…å ±
âœ… ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æå¯èƒ½
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‰¹æ€§æŠŠæ¡
âœ… ãƒ‡ãƒ¼ã‚¿å®¹é‡å‰Šæ¸›
âœ… æ©Ÿæ¢°å­¦ç¿’ã«æ´»ç”¨

ã€æ´»ç”¨æ–¹æ³•ã€‘
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—åˆ†é¡ï¼ˆæ±ºæ–­ãŒé€Ÿã„/æ…é‡æ´¾ãªã©ï¼‰
- è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³äºˆæ¸¬
- ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ¨è–¦
- A/Bãƒ†ã‚¹ãƒˆåŠ¹æœæ¸¬å®š
```

---

## 3-2. ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã®æ¯”è¼ƒ

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ 

```python
# é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¤œç´¢
def find_similar_users(user_id):
    """
    å…±é€šã®æ±‚äººã«interactã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
    """
    return db.query("""
        SELECT ui2.user_id, COUNT(*) as common_jobs
        FROM user_interactions ui1
        JOIN user_interactions ui2 ON ui1.job_id = ui2.job_id
        WHERE ui1.user_id = %s
          AND ui2.user_id != %s
        GROUP BY ui2.user_id
        ORDER BY common_jobs DESC
        LIMIT 10
    """, (user_id, user_id))

# ã§ãã‚‹ã“ã¨:
# - é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹
# - å¿œå‹Ÿç‡ã‚’è¨ˆç®—

# ã§ããªã„ã“ã¨:
# - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ€§æ ¼ã‚’ç†è§£
# - ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
# - è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³äºˆæ¸¬
```

---

### é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ 

```python
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒ…æ‹¬çš„ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
def get_user_behavior_profile(user_id):
    """
    é›†ç´„ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è©³ç´°åˆ†æ
    """
    
    # æœ€è¿‘3ãƒ¶æœˆã®çµ±è¨ˆ
    stats = db.query("""
        SELECT 
            AVG(apply_rate) as avg_apply_rate,
            AVG(view_to_apply_rate) as conversion_rate,
            AVG(avg_time_to_apply_days) as decision_time,
            MODE() WITHIN GROUP (
                ORDER BY most_interested_job_category
            ) as primary_interest
        FROM user_interaction_monthly_summary
        WHERE user_id = %s
          AND month >= NOW() - INTERVAL '3 months'
    """, (user_id,))
    
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—åˆ†é¡
    if stats.avg_apply_rate >= 10 and stats.decision_time <= 3:
        user_type = 'decisive'  # æ±ºæ–­ãŒé€Ÿã„
    elif stats.avg_apply_rate >= 10 and stats.decision_time > 7:
        user_type = 'cautious'  # æ…é‡æ´¾
    elif stats.avg_apply_rate < 5:
        user_type = 'browsing'  # è¦‹ã‚‹ã ã‘æ´¾
    
    return {
        'apply_rate': stats.avg_apply_rate,
        'conversion_rate': stats.conversion_rate,
        'decision_time': stats.decision_time,
        'primary_interest': stats.primary_interest,
        'user_type': user_type
    }

# ã§ãã‚‹ã“ã¨:
# âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ€§æ ¼ã‚’ç†è§£
# âœ… è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³äºˆæ¸¬
# âœ… ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºãƒ‰æ¨è–¦
# âœ… ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
# âœ… A/Bãƒ†ã‚¹ãƒˆåŠ¹æœæ¸¬å®š
# âœ… æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«è¨“ç·´
```

---

# 4. æ„å›³æŠ½å‡ºãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®æ¯”è¼ƒ

## 4-1. æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®æ„å›³æŠ½å‡º

```python
# ============================================
# æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ : ã‚·ãƒ³ãƒ—ãƒ«ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒ
# ============================================

def extract_user_intent_existing(message):
    """
    YES/NOåˆ¤å®šã®ã¿
    """
    
    message_lower = message.lower()
    
    # YESåˆ¤å®š
    if any(word in message_lower for word in ['ã¯ã„', 'yes', 'å¸Œæœ›', 'é‡è¦–']):
        return {'value': True, 'confidence': 0.8}
    
    # NOåˆ¤å®š
    elif any(word in message_lower for word in ['ã„ã„ãˆ', 'no', 'ä¸è¦']):
        return {'value': False, 'confidence': 0.8}
    
    # ä¸æ˜
    else:
        return {'value': None, 'confidence': 0.3}


# ä½¿ç”¨ä¾‹
user_message = "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å¸Œæœ›ã—ã¾ã™"
result = extract_user_intent_existing(user_message)
# â†’ {'value': True, 'confidence': 0.8}

# ä¿å­˜ã•ã‚Œã‚‹æƒ…å ±
INSERT INTO user_question_responses (
    user_id, question_key, response_text, normalized_response
) VALUES (
    4001, 'remote', 'ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å¸Œæœ›ã—ã¾ã™', 'yes'
)

ã€ç‰¹å¾´ã€‘
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âœ… å®Ÿè£…ãŒç°¡å˜
âœ… ã‚³ã‚¹ãƒˆã‚¼ãƒ­

âŒ YES/NOã—ã‹æŠ½å‡ºã§ããªã„
âŒ ç†ç”±ãŒã‚ã‹ã‚‰ãªã„
âŒ æ·±ã„å¸Œæœ›ã‚’ç†è§£ã§ããªã„
âŒ æ›–æ˜§ãªå›ç­”ã«å¯¾å¿œã§ããªã„
```

---

## 4-2. é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã®æ„å›³æŠ½å‡º

```python
# ============================================
# é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ : AIæ·±å±¤åˆ†æ
# ============================================

from openai import OpenAI
client = OpenAI()

def extract_user_intent_advanced(message):
    """
    AIã§å¤šå±¤çš„ã«æƒ…å ±ã‚’æŠ½å‡º
    """
    
    response = client.chat.completions.create(
        model="gpt-4",
        messages=[
            {
                "role": "system",
                "content": """
ã‚ãªãŸã¯ã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã§ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ä»¥ä¸‹ã‚’æŠ½å‡ºã—ã¦JSONå½¢å¼ã§è¿”ã—ã¦ãã ã•ã„:

1. explicit_preferencesï¼ˆæ˜ç¤ºçš„ãªå¸Œæœ›æ¡ä»¶ï¼‰
   - job_title, location, salary, remote_work ãªã©
   
2. implicit_valuesï¼ˆæš—é»™ã®ä¾¡å€¤è¦³ãƒ»å„ªå…ˆåº¦ã‚’1-5ã§æ¨å®šï¼‰
   - work_life_balance_priority
   - career_growth_priority
   - stability_priority
   - salary_priority
   
3. pain_pointsï¼ˆç¾åœ¨/éå»ã®ä¸æº€ç‚¹ï¼‰
   
4. motivationsï¼ˆè»¢è·ã®å‹•æ©Ÿï¼‰
   
5. emotional_stateï¼ˆæ„Ÿæƒ…ãƒ»æ…‹åº¦ï¼‰
   - sentiment: positive/negative/neutral
   - confidence: high/medium/low
   - urgency: high/medium/low
   
6. extracted_keywordsï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰

7. inferred_user_typeï¼ˆæ¨å®šã•ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ï¼‰
   - career_focused, work_life_balance_focused, etc.
   
8. follow_up_questionsï¼ˆè¿½åŠ ã§èãã¹ãã“ã¨ï¼‰

9. confidenceï¼ˆã“ã®åˆ†æã®ä¿¡é ¼åº¦ 0.0-1.0ï¼‰
"""
            },
            {
                "role": "user",
                "content": message
            }
        ],
        temperature=0.3,
        response_format={ "type": "json_object" }
    )
    
    return json.loads(response.choices[0].message.content)


# ä½¿ç”¨ä¾‹
user_message = "é€šå‹¤æ™‚é–“ãŒç‰‡é“1.5æ™‚é–“ã§ã€å®¶æ—ã¨ã®æ™‚é–“ã¨Reactã®å‹‰å¼·ã«ä½¿ã„ãŸã„ã§ã™"
result = extract_user_intent_advanced(user_message)

# è¿”ã£ã¦ãã‚‹æƒ…å ±ï¼ˆä¾‹ï¼‰
{
  "explicit_preferences": {
    "remote_work": "å¼·ãå¸Œæœ›",
    "commute_time_current": "ç‰‡é“1.5æ™‚é–“",
    "learning_interest": "React",
    "family_priority": "é«˜ã„"
  },
  
  "implicit_values": {
    "work_life_balance_priority": 5,  // 5æ®µéšã§5
    "career_growth_priority": 4,      // ã€Œå‹‰å¼·ã€ã‹ã‚‰æ¨å®š
    "stability_priority": 3,
    "salary_priority": 3
  },
  
  "pain_points": [
    "ç¾åœ¨ã®é€šå‹¤æ™‚é–“ãŒé•·ã„ï¼ˆç‰‡é“1.5æ™‚é–“ï¼‰",
    "å®¶æ—ã¨ã®æ™‚é–“ãŒå–ã‚Œã¦ã„ãªã„",
    "ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã®æ™‚é–“ãŒå–ã‚Œãªã„"
  ],
  
  "motivations": [
    "ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹ã®æ”¹å–„",
    "ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰"
  ],
  
  "emotional_state": {
    "sentiment": "positive",      // å‰å‘ã
    "confidence": "high",         // æ˜ç¢ºãªæ„æ€
    "urgency": "medium"           // æ€¥ã„ã§ã„ãªã„æ§˜å­
  },
  
  "extracted_keywords": [
    "é€šå‹¤æ™‚é–“", "1.5æ™‚é–“", "å®¶æ—", "React", "å‹‰å¼·"
  ],
  
  "inferred_user_type": "work_life_balance_focused",
  
  "follow_up_questions": [
    "Reactã‚’å‹‰å¼·ã—ãŸã„ç†ç”±ã¯å°†æ¥ã®ã‚­ãƒ£ãƒªã‚¢ã®ãŸã‚ã§ã™ã‹ï¼Ÿ",
    "å®Œå…¨ãƒªãƒ¢ãƒ¼ãƒˆã¨é€±3æ—¥ãƒªãƒ¢ãƒ¼ãƒˆã€ã©ã¡ã‚‰ãŒç†æƒ³ã§ã™ã‹ï¼Ÿ",
    "å®¶æ—ã¨ã®æ™‚é–“ã§ã¯å…·ä½“çš„ã«ä½•ã‚’ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã‹ï¼Ÿ"
  ],
  
  "confidence": 0.92
}

# è¤‡æ•°ã®ä¿å­˜å…ˆã«æŒ¯ã‚Šåˆ†ã‘
# 1. å›ºå®šã‚«ãƒ©ãƒ 
UPDATE user_profile SET
    work_life_balance_priority = 5,
    career_growth_priority = 4

# 2. JSONB
UPDATE user_dynamic_profile SET
    profile_data = jsonb_set(
        profile_data,
        '{learning_interests}',
        '["React"]'
    )

# 3. æŠ½å‡ºæƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«
INSERT INTO extracted_insights (
    user_id, insights, confidence_score
) VALUES (4001, result, 0.92)

# 4. ãƒãƒ£ãƒƒãƒˆå±¥æ­´ï¼ˆå®Œå…¨ãƒ†ã‚­ã‚¹ãƒˆï¼‰
INSERT INTO chat_history (
    user_id, sender, message
) VALUES (4001, 'user', user_message)

ã€ç‰¹å¾´ã€‘
âœ… å¤šå±¤çš„ãªæƒ…å ±æŠ½å‡º
âœ… æš—é»™ã®ä¾¡å€¤è¦³ã‚‚ç†è§£
âœ… æ„Ÿæƒ…ãƒ»æ…‹åº¦ã‚‚æŠŠæ¡
âœ… ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—è³ªå•ã‚’ææ¡ˆ
âœ… ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ä»˜ã

ã‚³ã‚¹ãƒˆ:
- 1å›ã‚ãŸã‚Šç´„$0.01-0.02
- 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ãŸã‚Š5-7å›ã®ä¼šè©±
- åˆè¨ˆ: $0.05-0.14/ãƒ¦ãƒ¼ã‚¶ãƒ¼
```

---

# 5. è³ªå•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã®æ¯”è¼ƒ

## 5-1. æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®è³ªå•ç”Ÿæˆ

```python
# ============================================
# æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ : å›ºå®šè³ªå•ãƒªã‚¹ãƒˆ
# ============================================

FIXED_QUESTIONS = {
    'remote': {
        'text': 'ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã¯å¸Œæœ›ã—ã¾ã™ã‹ï¼Ÿ',
        'category': 'åƒãæ–¹ã®æŸ”è»Ÿæ€§'
    },
    'company_size': {
        'text': 'ä¼æ¥­è¦æ¨¡ã«ã¤ã„ã¦å¸Œæœ›ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',
        'category': 'ä¼æ¥­æ–‡åŒ–ãƒ»é›°å›²æ°—'
    },
    'training': {
        'text': 'ç ”ä¿®åˆ¶åº¦ã¯é‡è¦–ã—ã¾ã™ã‹ï¼Ÿ',
        'category': 'ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹'
    },
    'side_job': {
        'text': 'å‰¯æ¥­ã¯è€ƒãˆã¦ã„ã¾ã™ã‹ï¼Ÿ',
        'category': 'åƒãæ–¹ã®æŸ”è»Ÿæ€§'
    }
}

def generate_next_question_existing(current_recommendations):
    """
    æ±‚äººã®å¤šæ§˜æ€§ã«åŸºã¥ã„ã¦æ¬¡ã®è³ªå•ã‚’é¸æŠ
    """
    
    # å„è³ªå•ã§ã®åˆ†æ•£ã‚’è¨ˆç®—
    diversity_scores = {}
    
    for key, question in FIXED_QUESTIONS.items():
        # ã“ã®è³ªå•ã§YES/NOã®åˆ†å¸ƒã‚’ç¢ºèª
        yes_count = count_jobs_with_attribute(
            current_recommendations, 
            key, 
            True
        )
        no_count = len(current_recommendations) - yes_count
        
        # åˆ†æ•£ã‚¹ã‚³ã‚¢ï¼ˆ50/50ã«è¿‘ã„ã»ã©é«˜ã„ï¼‰
        diversity_scores[key] = min(yes_count, no_count)
    
    # æœ€ã‚‚åˆ†æ•£ãŒå¤§ãã„è³ªå•ã‚’é¸æŠ
    best_question_key = max(diversity_scores, key=diversity_scores.get)
    
    return FIXED_QUESTIONS[best_question_key]


# å®Ÿéš›ã®æµã‚Œ
"""
1å›ç›®: ã€Œãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã¯å¸Œæœ›ã—ã¾ã™ã‹ï¼Ÿã€
      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã¯ã„ã€
      â†’ 43ä»¶ â†’ 21ä»¶

2å›ç›®: ã€Œä¼æ¥­è¦æ¨¡ã«ã¤ã„ã¦å¸Œæœ›ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€
      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œå¤§ä¼æ¥­ãŒã„ã„ã§ã™ã€
      â†’ 21ä»¶ â†’ 13ä»¶

3å›ç›®: ã€Œç ”ä¿®åˆ¶åº¦ã¯é‡è¦–ã—ã¾ã™ã‹ï¼Ÿã€
      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œã¯ã„ã€
      â†’ 13ä»¶ â†’ 3ä»¶

çµ‚äº†
"""

ã€ç‰¹å¾´ã€‘
âœ… ã‚·ãƒ³ãƒ—ãƒ«
âœ… å®Ÿè£…ãŒç°¡å˜
âœ… äºˆæ¸¬å¯èƒ½

âŒ è³ªå•ãŒç”»ä¸€çš„
âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚Œãªã„
âŒ ç†ç”±ã‚’æ·±æ˜ã‚Šã—ãªã„
âŒ ä¸€å•ä¸€ç­”ã§çµ‚ã‚ã‚‹
âŒ ä¼šè©±ã®æµã‚ŒãŒä¸è‡ªç„¶
```

---

## 5-2. é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã®è³ªå•ç”Ÿæˆ

```python
# ============================================
# é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ : AIå‹•çš„è³ªå•ç”Ÿæˆ
# ============================================

from openai import OpenAI
client = OpenAI()

class EvolvingQuestionGenerator:
    """
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç‰¹æ€§ã«å¿œã˜ã¦é€²åŒ–ã™ã‚‹è³ªå•ç”Ÿæˆå™¨
    """
    
    def __init__(self, user_id):
        self.user_id = user_id
        self.user_profile = self.load_user_profile()
        self.conversation_history = self.load_conversation_history()
    
    def generate_next_question(self, current_recommendations):
        """
        AIãŒæ–‡è„ˆã‚’ç†è§£ã—ã¦æ¬¡ã®è³ªå•ã‚’å‹•çš„ã«ç”Ÿæˆ
        """
        
        # AIã«é€ã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
        context = self._build_context(current_recommendations)
        
        response = client.chat.completions.create(
            model="gpt-4",
            messages=[
                {
                    "role": "system",
                    "content": self._get_system_prompt()
                },
                {
                    "role": "user",
                    "content": context
                }
            ],
            temperature=0.7
        )
        
        return self._parse_response(response.choices[0].message.content)
    
    def _get_system_prompt(self):
        return f"""
ã‚ãªãŸã¯å„ªç§€ãªã‚­ãƒ£ãƒªã‚¢ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã§ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æœ€é©ãªæ±‚äººã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã€æ·±ã„è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚

ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘
åŸºæœ¬ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«:
- å¸Œæœ›è·ç¨®: {self.user_profile.get('job_title', 'ä¸æ˜')}
- ã‚­ãƒ£ãƒªã‚¢ã‚¹ãƒ†ãƒ¼ã‚¸: {self.user_profile.get('career_stage', 'ä¸æ˜')}
- ã‚­ãƒ£ãƒªã‚¢ç›®æ¨™: {self.user_profile.get('career_goal', 'ä¸æ˜')}

å„ªå…ˆäº‹é …:
- ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹: {self.user_profile.get('wlb_priority', 3)}/5
- ã‚­ãƒ£ãƒªã‚¢æˆé•·: {self.user_profile.get('growth_priority', 3)}/5
- å¹´å: {self.user_profile.get('salary_priority', 3)}/5

æ„æ€æ±ºå®šã‚¹ã‚¿ã‚¤ãƒ«: {self.user_profile.get('decision_style', 'ä¸æ˜')}

ã€éå»ã®ä¼šè©±ã€‘
{self._format_conversation_history()}

ã€æŒ‡ç¤ºã€‘
1. ä¸€å•ä¸€ç­”ã§ã¯ãªãã€æ·±æ˜ã‚Šã™ã‚‹è³ªå•ã‚’ã—ã¦ãã ã•ã„
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ¬éŸ³ã‚’å¼•ãå‡ºã™è³ªå•ã«ã—ã¦ãã ã•ã„
3. å‰å›ã®ä¼šè©±ã‚’è¸ã¾ãˆãŸè³ªå•ã«ã—ã¦ãã ã•ã„
4. YES/NOã ã‘ã§ãªãã€ç†ç”±ã‚‚èã„ã¦ãã ã•ã„
5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ€§æ ¼ã«åˆã‚ã›ãŸèãæ–¹ã‚’ã—ã¦ãã ã•ã„

ã€è³ªå•ã®ãƒ¬ãƒ™ãƒ«ã€‘
- ãƒ¬ãƒ™ãƒ«1: è¡¨é¢çš„ï¼ˆYES/NOï¼‰
- ãƒ¬ãƒ™ãƒ«2: ç†ç”±ã‚’èãï¼ˆã€Œãªãœã€œã€ï¼‰
- ãƒ¬ãƒ™ãƒ«3: ä¾¡å€¤è¦³ã‚’æ¢ã‚‹ï¼ˆã€Œç†æƒ³ã®ã€œã€ï¼‰
- ãƒ¬ãƒ™ãƒ«4: ã‚·ãƒŠãƒªã‚ªæç¤ºï¼ˆã€Œã‚‚ã—ã€œã ã£ãŸã‚‰ã€ï¼‰

ç¾åœ¨ã®ä¼šè©±ã®æ·±ã•ã«å¿œã˜ã¦é©åˆ‡ãªãƒ¬ãƒ™ãƒ«ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚

ã€è¿”ç­”å½¢å¼ã€‘JSON
{{
  "question_text": "è³ªå•æ–‡",
  "question_type": "open_ended" | "scale" | "scenario",
  "reasoning": "ã“ã®è³ªå•ã‚’ã™ã‚‹ç†ç”±",
  "expected_insights": ["æœŸå¾…ã•ã‚Œã‚‹æ´å¯Ÿ1", "æ´å¯Ÿ2"],
  "follow_up_prompts": ["è¿½åŠ ã§èããŸã„ã“ã¨1", "ã“ã¨2"]
}}
"""
    
    def _build_context(self, current_recommendations):
        return f"""
ã€ç¾åœ¨ã®çŠ¶æ³ã€‘
å€™è£œæ±‚äººæ•°: {len(current_recommendations)}ä»¶

æ±‚äººã®åˆ†å¸ƒ:
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯å¯: {count_remote_jobs(current_recommendations)}ä»¶
- ç ”ä¿®åˆ¶åº¦ã‚ã‚Š: {count_training_jobs(current_recommendations)}ä»¶
- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—: {count_startup_jobs(current_recommendations)}ä»¶

ã€ä¼šè©±ã®æ·±ã•ã€‘
ç¾åœ¨ã®ãƒ¬ãƒ™ãƒ«: {self._calculate_conversation_depth()}

ã€ã‚¿ã‚¹ã‚¯ã€‘
æ¬¡ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«èãã¹ãè³ªå•ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ¬å½“ã®å¸Œæœ›ã‚’æ·±ãç†è§£ã§ãã‚‹è³ªå•ã«ã—ã¦ãã ã•ã„ã€‚
"""


# å®Ÿéš›ã®æµã‚Œï¼ˆä¾‹ï¼‰
"""
ã€ä¼šè©±é–‹å§‹ã€‘

AI: ã“ã‚“ã«ã¡ã¯ï¼ã¾ãšã€ã‚ãªãŸã®ç†æƒ³ã®åƒãæ–¹ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„ã€‚
    ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã«èˆˆå‘³ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿã‚‚ã—ã‚ã‚Œã°ã€ã©ã‚“ãªç‚¹ã«é­…åŠ›ã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ

ãƒ¦ãƒ¼ã‚¶ãƒ¼: ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å¸Œæœ›ã—ã¾ã™ã€‚é€šå‹¤æ™‚é–“ã‚’æ¸›ã‚‰ã—ãŸã„ã§ã™ã€‚

AI: é€šå‹¤æ™‚é–“ã®å‰Šæ¸›ã€ã¨ã¦ã‚‚é‡è¦ã§ã™ã‚ˆã­ã€‚
    ç¾åœ¨ã®é€šå‹¤æ™‚é–“ã¯ã©ã®ãã‚‰ã„ã§ã™ã‹ï¼Ÿ
    ã¾ãŸã€ãã®æ™‚é–“ã‚’ä½•ã«ä½¿ã„ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã‹ï¼Ÿ

ãƒ¦ãƒ¼ã‚¶ãƒ¼: ä»Šã¯ç‰‡é“1.5æ™‚é–“ã§ã™ã€‚å®¶æ—ã¨ã®æ™‚é–“ã¨ã€Reactã®å‹‰å¼·ã«ä½¿ã„ãŸã„ã§ã™ã€‚

AI: ãªã‚‹ã»ã©ã€1æ—¥3æ™‚é–“ã‚‚é€šå‹¤ã«ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ã€‚
    ãã‚Œã‚’å®¶æ—ã¨ã®æ™‚é–“ã¨Reactã®å‹‰å¼·ã«ä½¿ãˆãŸã‚‰ã€ã¨ã¦ã‚‚æœ‰æ„ç¾©ã§ã™ã­ã€‚
    
    Reactã®å‹‰å¼·ã«ã¤ã„ã¦ã‚‚ã†å°‘ã—èã‹ã›ã¦ãã ã•ã„ã€‚
    ã“ã‚Œã¯å°†æ¥ã®ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ã®ãŸã‚ã§ã™ã‹ï¼Ÿ
    ãã‚Œã¨ã‚‚ã€ä»Šã®æ¥­å‹™ã§å¿…è¦ã ã‹ã‚‰ã§ã™ã‹ï¼Ÿ

ãƒ¦ãƒ¼ã‚¶ãƒ¼: å°†æ¥ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã«ãªã‚ŠãŸã„ã‹ã‚‰ã§ã™ã€‚

AI: ç´ æ™´ã‚‰ã—ã„ç›®æ¨™ã§ã™ã­ï¼
    
    ãã‚Œã§ã¯ã€è·å ´é¸ã³ã«ã¤ã„ã¦ãŠèãã—ã¾ã™ã€‚
    ã‚‚ã—ä»¥ä¸‹ã®3ã¤ã®ç’°å¢ƒãŒã‚ã£ãŸã‚‰ã€ã©ã‚Œã‚’é¸ã³ã¾ã™ã‹ï¼Ÿ
    
    A) å®Œå…¨ãƒªãƒ¢ãƒ¼ãƒˆãƒ»å¹´å500ä¸‡å††ãƒ»ç‹¬å­¦ä¸­å¿ƒ
    B) é€±3æ—¥å‡ºç¤¾ãƒ»å¹´å600ä¸‡å††ãƒ»çµŒé¨“è±Šå¯Œãªãƒ¡ãƒ³ã‚¿ãƒ¼ä»˜ã
    C) å®Œå…¨å‡ºç¤¾ãƒ»å¹´å700ä¸‡å††ãƒ»æœ€æ–°æŠ€è¡“ã‚’ä½¿ãˆã‚‹ç’°å¢ƒ
    
    é¸ã‚“ã ç†ç”±ã‚‚æ•™ãˆã¦ãã ã•ã„ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼: Bã§ã™ã­ã€‚å¹´åã‚‚å¤§äº‹ã§ã™ãŒã€ãƒ¡ãƒ³ã‚¿ãƒ¼ã‹ã‚‰å­¦ã¹ã‚‹ã®ãŒä¸€ç•ªé‡è¦ã§ã™ã€‚

AI: ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã¨ã¦ã‚‚æ˜ç¢ºãªå„ªå…ˆé †ä½ã‚’ãŠæŒã¡ã§ã™ã­ã€‚
    
    æ•´ç†ã™ã‚‹ã¨:
    âœ… ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆé€±3æ—¥ä»¥ä¸Šï¼‰
    âœ… çµŒé¨“è±Šå¯Œãªãƒ¡ãƒ³ã‚¿ãƒ¼ãƒ»ãƒãƒ¼ãƒ 
    âœ… å­¦ç¿’æ©Ÿä¼šé‡è¦–
    âœ… å®¶æ—ã¨ã®æ™‚é–“ç¢ºä¿
    
    ã“ã®æ¡ä»¶ã§5ä»¶ã®æ±‚äººãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚
"""

ã€ç‰¹å¾´ã€‘
âœ… è‡ªç„¶ãªä¼šè©±ã®æµã‚Œ
âœ… æ·±æ˜ã‚Šè³ªå•
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
âœ… å‰å›ã®ä¼šè©±ã‚’è¸ã¾ãˆã‚‹
âœ… ç†ç”±ã‚’å¼•ãå‡ºã™
âœ… ã‚·ãƒŠãƒªã‚ªæç¤ºã§å„ªå…ˆé †ä½ã‚’ç†è§£

ã‚³ã‚¹ãƒˆ:
- è³ªå•ç”Ÿæˆ: $0.03/å›
- 1ã‚»ãƒƒã‚·ãƒ§ãƒ³5-7å›
- åˆè¨ˆ: $0.15-0.21/ãƒ¦ãƒ¼ã‚¶ãƒ¼
```

---

# 6. ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¯”è¼ƒ

## 6-1. æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒƒãƒãƒ³ã‚°

```python
# ============================================
# æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ : 3ã¤ã®æ‰‹æ³•
# ============================================

def get_recommendations_existing(user_id, current_filters):
    """
    1. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    2. ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°æ¤œç´¢
    3. é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼
    """
    
    # ========================================
    # æ‰‹æ³•1: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆæ¡ä»¶ãƒãƒƒãƒï¼‰
    # ========================================
    filtered_jobs = db.query("""
        SELECT * FROM company_profile
        WHERE job_title LIKE %s
          AND location_prefecture = %s
          AND salary_min >= %s
          AND remote = %s
          AND training = %s
          AND side_job = %s
        LIMIT 20
    """, (
        f"%{current_filters['job_title']}%",
        current_filters['location'],
        current_filters['salary'],
        current_filters['remote'],
        current_filters['training'],
        current_filters['side_job']
    ))
    
    # ========================================
    # æ‰‹æ³•2: ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°æ¤œç´¢ï¼ˆé¡ä¼¼æ±‚äººï¼‰
    # ========================================
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¼šè©±ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°å–å¾—
    user_embedding = get_user_embedding(user_id)
    
    similar_jobs = db.query("""
        SELECT 
            id, job_title, company_name,
            1 - (embedding <=> %s::vector) as similarity
        FROM company_profile
        WHERE embedding IS NOT NULL
        ORDER BY embedding <=> %s::vector
        LIMIT 5
    """, (user_embedding, user_embedding))
    
    # ========================================
    # æ‰‹æ³•3: å”èª¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆé¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
    # ========================================
    # é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
    similar_users = db.query("""
        SELECT ui2.user_id, COUNT(*) as common_jobs
        FROM user_interactions ui1
        JOIN user_interactions ui2 ON ui1.job_id = ui2.job_id
        WHERE ui1.user_id = %s
          AND ui2.user_id != %s
        GROUP BY ui2.user_id
        ORDER BY common_jobs DESC
        LIMIT 10
    """, (user_id, user_id))
    
    # é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¿œå‹Ÿã—ãŸæ±‚äºº
    collaborative_jobs = db.query("""
        SELECT cp.*, COUNT(*) as apply_count
        FROM user_interactions ui
        JOIN company_profile cp ON ui.job_id = cp.id
        WHERE ui.user_id IN %s
          AND ui.interaction_type = 'apply'
        GROUP BY cp.id
        ORDER BY apply_count DESC
        LIMIT 5
    """, (tuple(u['user_id'] for u in similar_users),))
    
    # ========================================
    # çµ±åˆï¼ˆå˜ç´”ãªçµåˆï¼‰
    # ========================================
    return {
        'filtered': filtered_jobs[:2],
        'similar': similar_jobs[:2],
        'collaborative': collaborative_jobs[:1]
    }


ã€ç‰¹å¾´ã€‘
âœ… 3ã¤ã®æ‰‹æ³•ã‚’çµ„ã¿åˆã‚ã›
âœ… å®Ÿè£…ãŒã‚·ãƒ³ãƒ—ãƒ«

âŒ é‡ã¿ä»˜ã‘ãŒå›ºå®š
âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç‰¹æ€§ã‚’è€ƒæ…®ã—ãªã„
âŒ ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãŒå˜ç´”
âŒ å­¦ç¿’ã—ãªã„
```

---

## 6-2. é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒƒãƒãƒ³ã‚°

```python
# ============================================
# é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ : å¤šå±¤çš„ãƒãƒƒãƒãƒ³ã‚° + AI
# ============================================

class AdvancedMatcher:
    """
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸ
    é€²åŒ–å‹ãƒãƒƒãƒãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 
    """
    
    def __init__(self, user_id):
        self.user_id = user_id
        self.user_profile = self.load_comprehensive_profile()
        self.behavior_pattern = self.analyze_behavior_pattern()
    
    def get_recommendations(self, filters):
        """
        å¤šå±¤çš„ãªãƒãƒƒãƒãƒ³ã‚°
        """
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼1: åŸºæœ¬ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        # ========================================
        candidates = self._filter_by_basic_criteria(filters)
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼2: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‰¹æ€§ãƒãƒƒãƒãƒ³ã‚°
        # ========================================
        candidates = self._match_by_user_characteristics(candidates)
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼3: è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
        # ========================================
        candidates = self._match_by_behavior_pattern(candidates)
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼4: ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°é¡ä¼¼åº¦
        # ========================================
        candidates = self._add_embedding_similarity(candidates)
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼5: å”èª¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        # ========================================
        candidates = self._add_collaborative_score(candidates)
        
        # ========================================
        # ãƒ¬ã‚¤ãƒ¤ãƒ¼6: AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
        # ========================================
        final_scores = self._ai_scoring(candidates)
        
        # ã‚½ãƒ¼ãƒˆã—ã¦è¿”ã™
        return sorted(final_scores, key=lambda x: x['final_score'], reverse=True)
    
    def _match_by_user_characteristics(self, candidates):
        """
        ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç‰¹æ€§ã«åŸºã¥ããƒãƒƒãƒãƒ³ã‚°
        """
        
        user_type = self.behavior_pattern['user_type']
        
        for job in candidates:
            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸé‡ã¿ä»˜ã‘
            if user_type == 'decisive':
                # æ±ºæ–­ãŒé€Ÿã„äºº â†’ å³å¿œå‹Ÿã§ãã‚‹æ±‚äººã‚’å„ªå…ˆ
                job['readiness_score'] = self._calculate_readiness(job)
                
            elif user_type == 'cautious':
                # æ…é‡æ´¾ â†’ è©³ç´°æƒ…å ±ãŒå……å®Ÿã—ã¦ã„ã‚‹æ±‚äººã‚’å„ªå…ˆ
                job['detail_score'] = self._calculate_detail_richness(job)
                
            elif user_type == 'browsing':
                # è¦‹ã‚‹ã ã‘æ´¾ â†’ ã¾ãšã¯èˆˆå‘³ã‚’å¼•ãæ±‚äººã‚’å¹…åºƒã
                job['interest_score'] = self._calculate_interest_potential(job)
        
        return candidates
    
    def _match_by_behavior_pattern(self, candidates):
        """
        éå»ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åŸºã¥ããƒãƒƒãƒãƒ³ã‚°
        """
        
        # éå»ã«å¿œå‹Ÿã—ãŸæ±‚äººã®ç‰¹å¾´ã‚’åˆ†æ
        past_applies = self._get_past_applies()
        
        # å…±é€šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡º
        patterns = {
            'avg_salary': np.mean([j['salary_min'] for j in past_applies]),
            'preferred_company_size': mode([j['company_size'] for j in past_applies]),
            'preferred_tech_stack': self._extract_common_tech(past_applies)
        }
        
        # å„å€™è£œæ±‚äººãŒãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã™ã‚‹ã‹è©•ä¾¡
        for job in candidates:
            job['pattern_match_score'] = self._calculate_pattern_match(
                job, patterns
            )
        
        return candidates
    
    def _ai_scoring(self, candidates):
        """
        AIã«ã‚ˆã‚‹æœ€çµ‚ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
        """
        
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªç„¶è¨€èªã§è¦ç´„
        user_summary = f"""
        ãƒ¦ãƒ¼ã‚¶ãƒ¼: {self.user_profile['job_title']}å¿—æœ›
        ã‚­ãƒ£ãƒªã‚¢ç›®æ¨™: {self.user_profile.get('career_goal', 'ä¸æ˜')}
        å„ªå…ˆäº‹é …:
        - ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹: {self.user_profile['wlb_priority']}/5
        - ã‚­ãƒ£ãƒªã‚¢æˆé•·: {self.user_profile['growth_priority']}/5
        
        éå»ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³:
        - å¿œå‹Ÿç‡: {self.behavior_pattern['apply_rate']}%
        - æ±ºæ–­ã‚¹ãƒ”ãƒ¼ãƒ‰: {self.behavior_pattern['decision_time']}æ—¥
        - ã‚¿ã‚¤ãƒ—: {self.behavior_pattern['user_type']}
        """
        
        # å„æ±‚äººã‚’AIã§è©•ä¾¡
        for job in candidates:
            job_summary = f"""
            æ±‚äºº: {job['job_title']}
            ä¼æ¥­: {job['company_name']}
            å¹´å: {job['salary_min']}-{job['salary_max']}ä¸‡å††
            ãƒªãƒ¢ãƒ¼ãƒˆ: {job.get('remote_work', 'ä¸æ˜')}
            ãƒãƒ¼ãƒ : {job.get('team_size', 'ä¸æ˜')}
            """
            
            # AIã«ãƒãƒƒãƒåº¦ã‚’è©•ä¾¡ã•ã›ã‚‹
            response = client.chat.completions.create(
                model="gpt-4",
                messages=[
                    {
                        "role": "system",
                        "content": """
ã‚ãªãŸã¯æ±‚äººãƒãƒƒãƒãƒ³ã‚°ã®å°‚é–€å®¶ã§ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨æ±‚äººæƒ…å ±ã‹ã‚‰ã€
ãƒãƒƒãƒåº¦ã‚’0-100ã§è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚

è©•ä¾¡åŸºæº–:
1. å¸Œæœ›æ¡ä»¶ã®ä¸€è‡´åº¦ï¼ˆ40ç‚¹ï¼‰
2. ã‚­ãƒ£ãƒªã‚¢ç›®æ¨™ã¨ã®æ•´åˆæ€§ï¼ˆ30ç‚¹ï¼‰
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ã¨ã®ç›¸æ€§ï¼ˆ20ç‚¹ï¼‰
4. é•·æœŸçš„ãªæº€è¶³åº¦äºˆæ¸¬ï¼ˆ10ç‚¹ï¼‰

JSONå½¢å¼ã§è¿”ã—ã¦ãã ã•ã„:
{
  "match_score": 85,
  "reasoning": "ç†ç”±",
  "strengths": ["å¼·ã¿1", "å¼·ã¿2"],
  "concerns": ["æ‡¸å¿µç‚¹1"]
}
"""
                    },
                    {
                        "role": "user",
                        "content": f"{user_summary}\n\n{job_summary}"
                    }
                ],
                response_format={ "type": "json_object" }
            )
            
            ai_result = json.loads(response.choices[0].message.content)
            job['ai_match_score'] = ai_result['match_score']
            job['ai_reasoning'] = ai_result['reasoning']
        
        # æœ€çµ‚ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆè¤‡æ•°ã®æŒ‡æ¨™ã‚’çµ±åˆï¼‰
        for job in candidates:
            job['final_score'] = (
                job.get('pattern_match_score', 50) * 0.2 +
                job.get('embedding_similarity', 0.5) * 100 * 0.3 +
                job.get('collaborative_score', 50) * 0.2 +
                job['ai_match_score'] * 0.3
            )
        
        return candidates


# å®Ÿéš›ã®æ¨è–¦çµæœ
"""
ã€æ¨è–¦çµæœï¼ˆTop 3ï¼‰ã€‘

1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ - æ ªå¼ä¼šç¤¾ãƒ†ãƒƒã‚¯ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³
   ãƒãƒƒãƒåº¦: 95%
   
   ã€ãªãœãƒãƒƒãƒï¼Ÿã€‘
   - é€±3æ—¥ãƒªãƒ¢ãƒ¼ãƒˆï¼ˆã‚ãªãŸã®å¸Œæœ›ã¨ä¸€è‡´ï¼‰
   - çµŒé¨“è±Šå¯ŒãªCTOï¼ˆå…ƒGoogleï¼‰ã‹ã‚‰å­¦ã¹ã‚‹
   - React/Next.js ã‚’ç©æ¥µæ´»ç”¨
   - å¹³å‡æ®‹æ¥­15æ™‚é–“ï¼ˆå®¶æ—æ™‚é–“ç¢ºä¿å¯èƒ½ï¼‰
   
   ã€AIã®è©•ä¾¡ã€‘
   "ã‚ãªãŸã®ã‚­ãƒ£ãƒªã‚¢ç›®æ¨™ã§ã‚ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã«
    æœ€é©ãªç’°å¢ƒã§ã™ã€‚ç‰¹ã«ã€ãƒ¡ãƒ³ã‚¿ãƒ¼ã‹ã‚‰å­¦ã¹ã‚‹ç‚¹ãŒé‡è¦ãª
    ã‚ãªãŸã®å„ªå…ˆé †ä½ã¨å®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ã¾ã™ã€‚"
   
   ã€é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å®Ÿç¸¾ã€‘
   3äººã®é¡ä¼¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¿œå‹Ÿã—ã€2äººãŒæ¡ç”¨ã•ã‚Œã¾ã—ãŸã€‚

2. UIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ - æ ªå¼ä¼šç¤¾ã‚°ãƒ­ãƒ¼ã‚¹ãƒ©ãƒœ
   ãƒãƒƒãƒåº¦: 88%
   ...

3. Webãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ - æ ªå¼ä¼šç¤¾ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ¯ãƒ¼ã‚¯ã‚¹
   ãƒãƒƒãƒåº¦: 82%
   ...
"""

ã€ç‰¹å¾´ã€‘
âœ… å¤šå±¤çš„ãªè©•ä¾¡
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ç‰¹æ€§ã‚’è€ƒæ…®
âœ… è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
âœ… AIã«ã‚ˆã‚‹ç·åˆåˆ¤æ–­
âœ… ç†ç”±ã‚’èª¬æ˜å¯èƒ½
âœ… ç¶™ç¶šçš„ã«å­¦ç¿’

ã‚³ã‚¹ãƒˆ:
- AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°: $0.05/æ±‚äºº
- Top 10è©•ä¾¡ã§: $0.50/ã‚»ãƒƒã‚·ãƒ§ãƒ³
```

---

# 7. å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã®æ¯”è¼ƒ

## 7-1. ãƒãƒ£ãƒƒãƒˆå‡¦ç†ã®æ¯”è¼ƒ

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ 

```python
# ============================================
# æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ : ã‚·ãƒ³ãƒ—ãƒ«ãªãƒãƒ£ãƒƒãƒˆå‡¦ç†
# ============================================

@app.post("/chat")
async def chat_existing(user_id: int, message: str):
    """
    æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ£ãƒƒãƒˆå‡¦ç†
    """
    
    # 1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
    save_message(user_id, 'user', message)
    
    # 2. YES/NOåˆ¤å®š
    intent = extract_simple_intent(message)
    
    # 3. ãƒ•ã‚£ãƒ«ã‚¿æ›´æ–°
    if intent['value'] == True:
        current_filters['remote'] = True
    
    # 4. æ±‚äººã‚’å†æ¤œç´¢
    jobs = filter_jobs(current_filters)
    
    # 5. æ¬¡ã®è³ªå•ã‚’é¸æŠï¼ˆå›ºå®šãƒªã‚¹ãƒˆï¼‰
    next_question = select_next_question(jobs)
    
    # 6. ãƒœãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    bot_message = f"{len(jobs)}ä»¶ã«çµã‚Šè¾¼ã¾ã‚Œã¾ã—ãŸã€‚{next_question}"
    save_message(user_id, 'bot', bot_message)
    
    return {
        'message': bot_message,
        'job_count': len(jobs),
        'jobs': jobs[:5]
    }

# ã‚³ãƒ¼ãƒ‰è¡Œæ•°: ç´„50è¡Œ
# å‡¦ç†æ™‚é–“: 100ms
# ã‚³ã‚¹ãƒˆ: $0
```

---

### é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ 

```python
# ============================================
# é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ : AIé§†å‹•ã®ãƒãƒ£ãƒƒãƒˆå‡¦ç†
# ============================================

@app.post("/chat")
async def chat_advanced(user_id: int, message: str, session_id: str):
    """
    é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ£ãƒƒãƒˆå‡¦ç†
    """
    
    # 1. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–
    manager = UserProfileManager(user_id)
    
    # 2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ï¼ˆå®Œå…¨ãƒ†ã‚­ã‚¹ãƒˆï¼‰
    message_id = manager.save_chat_message(
        session_id, 'user', message
    )
    
    # 3. AIã§æ·±å±¤åˆ†æ
    insights = manager.extract_and_save_insights(message, message_id)
    
    # 4. ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°æ›´æ–°
    manager.update_conversation_embedding(session_id)
    
    # 5. æ±‚äººã‚’å¤šå±¤çš„ã«ãƒãƒƒãƒãƒ³ã‚°
    matcher = AdvancedMatcher(user_id)
    jobs = matcher.get_recommendations(current_filters)
    
    # 6. AIè³ªå•ç”Ÿæˆå™¨ã§æ¬¡ã®è³ªå•ã‚’å‹•çš„ç”Ÿæˆ
    generator = EvolvingQuestionGenerator(user_id)
    next_question = generator.generate_next_question(jobs)
    
    # 7. ãƒœãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ§‹ç¯‰
    bot_message = f"""
{len(jobs)}ä»¶ã«çµã‚Šè¾¼ã¾ã‚Œã¾ã—ãŸã€‚

{insights.get('emotional_state', {}).get('sentiment') == 'positive' and 
 'å‰å‘ããªå§¿å‹¢ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼' or ''}

{next_question['question_text']}

{next_question.get('follow_up_prompts') and 
 f"ï¼ˆä¾‹: {', '.join(next_question['follow_up_prompts'][:2])}ï¼‰" or ''}
"""
    
    # 8. ãƒœãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜
    manager.save_chat_message(session_id, 'bot', bot_message)
    
    # 9. å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’è“„ç©
    manager.track_conversation_quality(insights, next_question)
    
    manager.close()
    
    return {
        'message': bot_message,
        'job_count': len(jobs),
        'jobs': jobs[:5],
        'insights': insights,  # ãƒ‡ãƒãƒƒã‚°ç”¨
        'match_scores': [j['final_score'] for j in jobs[:5]]
    }

# ã‚³ãƒ¼ãƒ‰è¡Œæ•°: ç´„500è¡Œï¼ˆã‚¯ãƒ©ã‚¹å«ã‚€ï¼‰
# å‡¦ç†æ™‚é–“: 800ms
# ã‚³ã‚¹ãƒˆ: $0.05-0.10/ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```

---

# 8. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚³ã‚¹ãƒˆã®æ¯”è¼ƒ

## 8-1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å‡¦ç†æ™‚é–“ã®æ¯”è¼ƒ                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã€‘
- ãƒãƒ£ãƒƒãƒˆå‡¦ç†: 100ms
- æ±‚äººæ¤œç´¢: 50ms
- è³ªå•ç”Ÿæˆ: 10msï¼ˆå›ºå®šãƒªã‚¹ãƒˆï¼‰
- åˆè¨ˆ: ç´„160ms

ã€é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã€‘
- ãƒãƒ£ãƒƒãƒˆå‡¦ç†: 200ms
- AIæƒ…å ±æŠ½å‡º: 300ms
- ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆ: 200ms
- æ±‚äººæ¤œç´¢ï¼ˆå¤šå±¤ï¼‰: 150ms
- AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°: 500ms
- AIè³ªå•ç”Ÿæˆ: 300ms
- åˆè¨ˆ: ç´„1,650ms

â†’ ç´„10å€é…ã„

ãŸã ã—:
âœ… ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥ã§500msç¨‹åº¦ã«çŸ­ç¸®å¯èƒ½
âœ… éåŒæœŸå‡¦ç†ã§ä½“æ„Ÿé€Ÿåº¦å‘ä¸Š
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚ˆã‚Šè‰¯ã„æ¨è–¦ã‚’å¾—ã‚‰ã‚Œã‚‹
```

---

## 8-2. ã‚³ã‚¹ãƒˆæ¯”è¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æœˆé–“ã‚³ã‚¹ãƒˆæ¯”è¼ƒï¼ˆ1,000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã€‘
OpenAI ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°: $50/æœˆ
- æ±‚äººã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°: 5,000ä»¶ Ã— $0.00001 = $0.05
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°: 1,000äºº Ã— 5å› Ã— $0.00001 = $0.05

ã‚µãƒ¼ãƒãƒ¼ã‚³ã‚¹ãƒˆ: $100/æœˆ
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: $50/æœˆ

åˆè¨ˆ: ç´„$200/æœˆ

ã€é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã€‘
OpenAI ã‚³ã‚¹ãƒˆ: $500/æœˆ
- ã‚¨ãƒ³ãƒ™ãƒ‡ã‚£ãƒ³ã‚°: $50
- æƒ…å ±æŠ½å‡ºï¼ˆGPT-4ï¼‰: 1,000äºº Ã— 5å› Ã— $0.01 = $50
- è³ªå•ç”Ÿæˆï¼ˆGPT-4ï¼‰: 1,000äºº Ã— 5å› Ã— $0.03 = $150
- AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆGPT-4ï¼‰: 1,000äºº Ã— 5å› Ã— $0.05 = $250

ã‚µãƒ¼ãƒãƒ¼ã‚³ã‚¹ãƒˆ: $150/æœˆï¼ˆå‡¦ç†å¢—åŠ ï¼‰
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: $80/æœˆï¼ˆãƒ‡ãƒ¼ã‚¿å¢—åŠ ï¼‰

åˆè¨ˆ: ç´„$730/æœˆ

â†’ 3.6å€ã®ã‚³ã‚¹ãƒˆå¢—

ãŸã ã—:
âœ… å¿œå‹Ÿç‡2å€ï¼ˆ5% â†’ 10%ï¼‰
âœ… æˆç´„ç‡å‘ä¸Šï¼ˆæœˆé–“5ä»¶ â†’ 10ä»¶ï¼‰
âœ… 1ä»¶ã‚ãŸã‚Šå£²ä¸Š$1,000ã¨ã—ã¦
âœ… æœˆé–“å£²ä¸Šå¢—: $5,000
âœ… ROI: ($5,000 - $530) / $530 = 843%

æŠ•è³‡å¯¾åŠ¹æœã¯éå¸¸ã«é«˜ã„
```

---

## 8-3. ç·åˆæ¯”è¼ƒè¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ—¢å­˜ vs é€²åŒ–å‹ ç·åˆæ¯”è¼ƒ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é …ç›®         â”‚ æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ   â”‚ é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®Ÿè£…é›£æ˜“åº¦   â”‚ â˜…â˜…â˜†â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜†              â”‚
â”‚ ä¿å®ˆæ€§       â”‚ â˜…â˜…â˜…â˜…â˜†      â”‚ â˜…â˜…â˜…â˜†â˜†              â”‚
â”‚ æ‹¡å¼µæ€§       â”‚ â˜…â˜…â˜†â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â”‚ ãƒãƒƒãƒãƒ³ã‚°ç²¾åº¦â”‚ â˜…â˜…â˜…â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“  â”‚ â˜…â˜…â˜…â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â”‚ å‡¦ç†é€Ÿåº¦     â”‚ â˜…â˜…â˜…â˜…â˜…      â”‚ â˜…â˜…â˜…â˜†â˜†              â”‚
â”‚ ã‚³ã‚¹ãƒˆ       â”‚ â˜…â˜…â˜…â˜…â˜…      â”‚ â˜…â˜…â˜†â˜†â˜†              â”‚
â”‚ ãƒ‡ãƒ¼ã‚¿åŠ¹ç‡   â”‚ â˜…â˜…â˜†â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â”‚ å­¦ç¿’èƒ½åŠ›     â”‚ â˜…â˜†â˜†â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â”‚ ROI          â”‚ â˜…â˜…â˜…â˜†â˜†      â”‚ â˜…â˜…â˜…â˜…â˜…              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€æ¨å¥¨ã€‘
- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—åˆæœŸ: æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã§ååˆ†
- ã‚°ãƒ­ãƒ¼ã‚¹æœŸä»¥é™: é€²åŒ–å‹ã‚·ã‚¹ãƒ†ãƒ ã«ç§»è¡Œ
- æ®µéšçš„å°å…¥: ã¾ãšä¸€éƒ¨æ©Ÿèƒ½ã‹ã‚‰
```

---

# ğŸ¯ ã¾ã¨ã‚

## âœ… ä¸»è¦ãªé•ã„

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```
æ—¢å­˜: ã‚·ãƒ³ãƒ—ãƒ«ãª12ãƒ†ãƒ¼ãƒ–ãƒ«
é€²åŒ–å‹: +6ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆJSONBã€é›†ç´„ã€ã‚¤ãƒ³ã‚µã‚¤ãƒˆï¼‰
```

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•å±¥æ­´
```
æ—¢å­˜: åŸºæœ¬çš„ãªè¡Œå‹•ã®ã¿ï¼ˆclick, view, applyï¼‰
é€²åŒ–å‹: è©³ç´°çµ±è¨ˆ + æœˆæ¬¡/å¹´æ¬¡é›†ç´„ + ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
```

### 3. æ„å›³æŠ½å‡º
```
æ—¢å­˜: YES/NOåˆ¤å®šã®ã¿
é€²åŒ–å‹: AIå¤šå±¤åˆ†æï¼ˆæ˜ç¤ºçš„+æš—é»™çš„+æ„Ÿæƒ…ï¼‰
```

### 4. è³ªå•ç”Ÿæˆ
```
æ—¢å­˜: å›ºå®šè³ªå•ãƒªã‚¹ãƒˆ
é€²åŒ–å‹: AIå‹•çš„ç”Ÿæˆ + æ·±æ˜ã‚Š + ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚º
```

### 5. ãƒãƒƒãƒãƒ³ã‚°
```
æ—¢å­˜: 3æ‰‹æ³•ã®å˜ç´”çµ±åˆ
é€²åŒ–å‹: 6ãƒ¬ã‚¤ãƒ¤ãƒ¼ + AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚° + å­¦ç¿’
```

### 6. ã‚³ã‚¹ãƒˆ
```
æ—¢å­˜: $200/æœˆ
é€²åŒ–å‹: $730/æœˆï¼ˆãŸã ã—ROI 843%ï¼‰
```

---

## ğŸš€ ç§»è¡Œæˆ¦ç•¥

### ãƒ•ã‚§ãƒ¼ã‚º1: ãƒ‡ãƒ¼ã‚¿åŸºç›¤ï¼ˆWeek 1-2ï¼‰
- user_dynamic_profile è¿½åŠ 
- extracted_insights è¿½åŠ 
- é›†ç´„ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 

### ãƒ•ã‚§ãƒ¼ã‚º2: AIçµ±åˆï¼ˆWeek 3-4ï¼‰
- æƒ…å ±æŠ½å‡ºAIå®Ÿè£…
- è³ªå•ç”ŸæˆAIå®Ÿè£…

### ãƒ•ã‚§ãƒ¼ã‚º3: ãƒãƒƒãƒãƒ³ã‚°æ”¹å–„ï¼ˆWeek 5-6ï¼‰
- å¤šå±¤ãƒãƒƒãƒãƒ³ã‚°å®Ÿè£…
- AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°å®Ÿè£…

### ãƒ•ã‚§ãƒ¼ã‚º4: æœ€é©åŒ–ï¼ˆWeek 7-8ï¼‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
- éåŒæœŸå‡¦ç†
- A/Bãƒ†ã‚¹ãƒˆ

---

**æ®µéšçš„ã«å°å…¥ã™ã‚Œã°ã€ãƒªã‚¹ã‚¯ã‚’æŠ‘ãˆãªãŒã‚‰é€²åŒ–ã§ãã¾ã™ï¼** ğŸ‰
