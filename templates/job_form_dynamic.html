<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‚äººç™»éŒ²ï¼ˆå‹•çš„ãƒ•ã‚©ãƒ¼ãƒ ï¼‰ - JobMatch AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }
        
        .header {
            background: #fff;
            border-bottom: 1px solid #e1e4e8;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0366d6;
        }
        
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .form-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 2.5rem;
        }
        
        .form-header {
            margin-bottom: 2rem;
        }
        
        .form-header h1 {
            font-size: 2rem;
            color: #24292e;
            margin-bottom: 0.5rem;
        }
        
        .form-header p {
            color: #586069;
            line-height: 1.6;
        }
        
        .section {
            margin-bottom: 2.5rem;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #24292e;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #e1e4e8;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .section-icon {
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #24292e;
            font-size: 0.95rem;
        }
        
        .required {
            color: #dc3545;
            margin-left: 0.25rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e1e4e8;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.2s;
            background: #f8f9fa;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0366d6;
            background: white;
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }
        
        .form-hint {
            font-size: 0.85rem;
            color: #586069;
            margin-top: 0.5rem;
            display: block;
        }
        
        .guided-section {
            background: #f6f8fa;
            border: 2px dashed #d1d5da;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .guided-section-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #24292e;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .guided-section textarea {
            background: white;
            border: 1px solid #d1d5da;
        }
        
        .hint-list {
            font-size: 0.85rem;
            color: #586069;
            margin-top: 0.5rem;
            padding-left: 1.5rem;
        }
        
        .hint-list li {
            margin-bottom: 0.25rem;
        }
        
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e1e4e8;
        }
        
        .btn {
            padding: 0.875rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background: #0366d6;
            color: white;
            flex: 1;
        }
        
        .btn-primary:hover {
            background: #0256c1;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(3, 102, 214, 0.3);
        }
        
        .btn-secondary {
            background: #f6f8fa;
            color: #24292e;
            border: 1px solid #e1e4e8;
        }
        
        .btn-secondary:hover {
            background: #e1e4e8;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .loading-overlay.show {
            display: flex;
        }
        
        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0366d6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .dynamic-field {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #1976d2;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1.5rem;
        }
        
        .info-box p {
            color: #1565c0;
            font-size: 0.9rem;
            margin: 0;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">ğŸ¯ JobMatch AI</div>
    </header>
    
    <div class="container">
        <div class="form-container">
            <div class="form-header">
                <h1>ğŸ“ æ±‚äººæƒ…å ±ç™»éŒ²</h1>
                <p>åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›å¾Œã€è©³ç´°ã‚’è‡ªç”±ã«è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚AIãŒè‡ªå‹•ã§æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—ã¾ã™ã€‚</p>
            </div>
            
            <div class="info-box">
                <p>ğŸ’¡ ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã¯è‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™ã€‚é »ç¹ã«æ±‚ã‚ã‚‰ã‚Œã‚‹é …ç›®ã¯ã€ä»Šå¾Œã€ŒåŸºæœ¬é …ç›®ã€ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
            </div>
            
            <form id="jobForm" method="POST" action="/job/new">
                <!-- åŸºæœ¬æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="section">
                    <div class="section-title">
                        <span class="section-icon">ğŸ“‹</span>
                        åŸºæœ¬æƒ…å ±
                    </div>
                    
                    <div id="requiredFields">
                        <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹å¿…é ˆé …ç›® -->
                    </div>
                </div>
                
                <!-- ã‚¬ã‚¤ãƒ‰ä»˜ãè‡ªç”±è¨˜è¿°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="section">
                    <div class="section-title">
                        <span class="section-icon">âœï¸</span>
                        æ±‚äººè©³ç´°ï¼ˆã‚¬ã‚¤ãƒ‰ä»˜ãè‡ªç”±è¨˜è¿°ï¼‰
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            ğŸ’¼ ã©ã‚“ãªä»•äº‹ã‚’ã—ã¾ã™ã‹?
                        </div>
                        <textarea 
                            name="job_content" 
                            placeholder="ä¾‹:&#10;â€¢ React/TypeScriptã‚’ä½¿ã£ãŸè‡ªç¤¾SaaSã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º&#10;â€¢ æ–°æ©Ÿèƒ½ã®è¨­è¨ˆã‹ã‚‰å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã¾ã§ä¸€è²«ã—ã¦æ‹…å½“&#10;â€¢ UXãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã¨å”åŠ›ã—ã¦UIæ”¹å–„ã‚‚è¡Œã„ã¾ã™"
                        ></textarea>
                        <ul class="hint-list">
                            <li>å…·ä½“çš„ãªæ¥­å‹™å†…å®¹</li>
                            <li>ä½¿ç”¨ã™ã‚‹æŠ€è¡“ãƒ»ãƒ„ãƒ¼ãƒ«</li>
                            <li>æ‹…å½“ã™ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆè¨­è¨ˆ/å®Ÿè£…/é‹ç”¨ãªã©ï¼‰</li>
                        </ul>
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            ğŸ  ã©ã‚“ãªåƒãæ–¹ãŒã§ãã¾ã™ã‹?
                        </div>
                        <textarea 
                            name="work_style" 
                            placeholder="ä¾‹:&#10;â€¢ é€±2æ—¥ãƒªãƒ¢ãƒ¼ãƒˆå¯ï¼ˆæ°´æ›œãƒ»é‡‘æ›œï¼‰&#10;â€¢ 10æ™‚å‡ºç¤¾ã‚‚OKï¼ˆã‚³ã‚¢ã‚¿ã‚¤ãƒ 11-15æ™‚ï¼‰&#10;â€¢ æœè£…è‡ªç”±"
                        ></textarea>
                        <ul class="hint-list">
                            <li>ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®é »åº¦</li>
                            <li>å‡ºç¤¾æ™‚é–“ã®æŸ”è»Ÿæ€§</li>
                            <li>æœè£…è¦å®šã€æ®‹æ¥­ã®é »åº¦</li>
                        </ul>
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            ğŸ‘¥ ã©ã‚“ãªãƒãƒ¼ãƒ ã§ã™ã‹?
                        </div>
                        <textarea 
                            name="team_culture" 
                            placeholder="ä¾‹:&#10;â€¢ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢8åã€ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼2åã€PdM1å&#10;â€¢ é€±1ã§1on1ã€æœˆ1ã§ãµã‚Šã‹ãˆã‚Šä¼š&#10;â€¢ å¹´é½¢é–¢ä¿‚ãªããƒ•ãƒ©ãƒƒãƒˆã«æ„è¦‹ã‚’è¨€ãˆã‚‹é›°å›²æ°—"
                        ></textarea>
                        <ul class="hint-list">
                            <li>ãƒãƒ¼ãƒ ã®äººæ•°ãƒ»æ§‹æˆ</li>
                            <li>ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é »åº¦</li>
                            <li>ãƒãƒ¼ãƒ ã®é›°å›²æ°—ãƒ»æ–‡åŒ–</li>
                        </ul>
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            ğŸ ã©ã‚“ãªç¦åˆ©åšç”ŸãŒã‚ã‚Šã¾ã™ã‹?
                        </div>
                        <textarea 
                            name="benefits" 
                            placeholder="ä¾‹:&#10;â€¢ æ›¸ç±è³¼å…¥è£œåŠ©ï¼ˆæœˆ3ä¸‡å††ã¾ã§ï¼‰&#10;â€¢ ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å‚åŠ è²»å…¨é¡è£œåŠ©&#10;â€¢ ç¤¾å“¡é£Ÿå ‚ã‚ã‚Šï¼ˆãƒ©ãƒ³ãƒè£œåŠ©ï¼‰"
                        ></textarea>
                        <ul class="hint-list">
                            <li>å­¦ç¿’æ”¯æ´åˆ¶åº¦</li>
                            <li>å„ç¨®æ‰‹å½“</li>
                            <li>ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªç¦åˆ©åšç”Ÿ</li>
                        </ul>
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            ğŸŒ± ã©ã‚“ãªæˆé•·æ©Ÿä¼šãŒã‚ã‚Šã¾ã™ã‹?
                        </div>
                        <textarea 
                            name="growth" 
                            placeholder="ä¾‹:&#10;â€¢ ç¤¾å†…å‹‰å¼·ä¼šã‚’æœˆ2å›é–‹å‚¬&#10;â€¢ ãƒ¡ãƒ³ã‚¿ãƒ¼åˆ¶åº¦ã‚ã‚Š&#10;â€¢ æ–°æŠ€è¡“ã®å°å…¥ã‚’ç©æ¥µçš„ã«æ¨å¥¨"
                        ></textarea>
                        <ul class="hint-list">
                            <li>ç ”ä¿®åˆ¶åº¦</li>
                            <li>å‹‰å¼·ä¼šã®é »åº¦</li>
                            <li>ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã®é¸æŠè‚¢</li>
                        </ul>
                    </div>
                    
                    <div class="guided-section">
                        <div class="guided-section-title">
                            âœ¨ ãã®ä»–ã®ã‚¢ãƒ”ãƒ¼ãƒ«ãƒã‚¤ãƒ³ãƒˆã¯?
                        </div>
                        <textarea 
                            name="appeal" 
                            placeholder="ä¾‹:&#10;â€¢ ç¾åœ¨ã€æ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ã®ç«‹ã¡ä¸Šã’ãƒ•ã‚§ãƒ¼ã‚º&#10;â€¢ æœ€æ–°ã®MacBook Pro + 4Kãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤2å°æ”¯çµ¦&#10;â€¢ ã‚ªãƒ•ã‚£ã‚¹ã«ã‚µã‚¦ãƒŠå®Œå‚™&#10;â€¢ å‰¯æ¥­OK"
                        ></textarea>
                        <ul class="hint-list">
                            <li>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ³</li>
                            <li>ã‚ªãƒ•ã‚£ã‚¹ç’°å¢ƒãƒ»è¨­å‚™</li>
                            <li>ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªåˆ¶åº¦</li>
                        </ul>
                    </div>
                </div>
                
                <!-- ä»»æ„é …ç›®ï¼ˆå‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹ï¼‰ -->
                <div class="section" id="optionalSection" style="display: none;">
                    <div class="section-title">
                        <span class="section-icon">âš™ï¸</span>
                        è¿½åŠ æƒ…å ±ï¼ˆä»»æ„ï¼‰
                    </div>
                    
                    <div id="optionalFields">
                        <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ä»»æ„é …ç›® -->
                    </div>
                </div>
                
                <!-- ãƒœã‚¿ãƒ³ -->
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="history.back()">
                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                    <button type="submit" class="btn btn-primary">
                        ğŸ“¤ æ±‚äººã‚’ç™»éŒ²ã™ã‚‹
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>åŸºæœ¬é …ç›®ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</p>
        </div>
    </div>
    
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            loadBaselineFields();
        });
        
        // åŸºæœ¬é …ç›®ã‚’èª­ã¿è¾¼ã‚€
        async function loadBaselineFields() {
            const overlay = document.getElementById('loadingOverlay');
            overlay.classList.add('show');
            
            try {
                const response = await fetch('/enrichment/baseline-fields');
                const data = await response.json();
                
                // å¿…é ˆé …ç›®ã‚’ç”Ÿæˆ
                renderFields(data.required_fields, 'requiredFields', true);
                
                // ä»»æ„é …ç›®ã‚’ç”Ÿæˆ
                if (data.optional_fields && data.optional_fields.length > 0) {
                    renderFields(data.optional_fields, 'optionalFields', false);
                    document.getElementById('optionalSection').style.display = 'block';
                }
                
                overlay.classList.remove('show');
            } catch (error) {
                console.error('Error loading baseline fields:', error);
                overlay.classList.remove('show');
                alert('åŸºæœ¬é …ç›®ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
            }
        }
        
        // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æç”»
        function renderFields(fields, containerId, isRequired) {
            const container = document.getElementById(containerId);
            
            fields.forEach(field => {
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group dynamic-field';
                
                // ãƒ©ãƒ™ãƒ«
                const label = document.createElement('label');
                label.setAttribute('for', field.field_name);
                label.innerHTML = field.label;
                if (isRequired || field.required) {
                    label.innerHTML += '<span class="required">*</span>';
                }
                formGroup.appendChild(label);
                
                // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
                const input = createInputElement(field);
                formGroup.appendChild(input);
                
                // ãƒ’ãƒ³ãƒˆ
                if (field.placeholder) {
                    const hint = document.createElement('span');
                    hint.className = 'form-hint';
                    hint.textContent = field.placeholder;
                    formGroup.appendChild(hint);
                }
                
                container.appendChild(formGroup);
            });
        }
        
        // å…¥åŠ›è¦ç´ ã‚’ç”Ÿæˆ
        function createInputElement(field) {
            let input;
            
            switch (field.field_type) {
                case 'select':
                    input = document.createElement('select');
                    input.id = field.field_name;
                    input.name = field.field_name;
                    
                    // ç©ºã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³
                    const emptyOption = document.createElement('option');
                    emptyOption.value = '';
                    emptyOption.textContent = 'é¸æŠã—ã¦ãã ã•ã„';
                    input.appendChild(emptyOption);
                    
                    // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
                    if (field.options) {
                        const options = JSON.parse(field.options);
                        options.forEach(opt => {
                            const option = document.createElement('option');
                            option.value = opt;
                            option.textContent = opt;
                            input.appendChild(option);
                        });
                    }
                    break;
                
                case 'textarea':
                    input = document.createElement('textarea');
                    input.id = field.field_name;
                    input.name = field.field_name;
                    input.placeholder = field.placeholder || '';
                    break;
                
                case 'number':
                    input = document.createElement('input');
                    input.type = 'number';
                    input.id = field.field_name;
                    input.name = field.field_name;
                    input.placeholder = field.placeholder || '';
                    break;
                
                case 'time':
                    input = document.createElement('input');
                    input.type = 'time';
                    input.id = field.field_name;
                    input.name = field.field_name;
                    break;
                
                case 'boolean':
                    input = document.createElement('select');
                    input.id = field.field_name;
                    input.name = field.field_name;
                    
                    const boolOptions = [
                        { value: '', text: 'é¸æŠã—ã¦ãã ã•ã„' },
                        { value: 'true', text: 'ã¯ã„' },
                        { value: 'false', text: 'ã„ã„ãˆ' }
                    ];
                    
                    boolOptions.forEach(opt => {
                        const option = document.createElement('option');
                        option.value = opt.value;
                        option.textContent = opt.text;
                        input.appendChild(option);
                    });
                    break;
                
                default:
                    input = document.createElement('input');
                    input.type = 'text';
                    input.id = field.field_name;
                    input.name = field.field_name;
                    input.placeholder = field.placeholder || '';
            }
            
            if (field.required) {
                input.required = true;
            }
            
            return input;
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®å‡¦ç†
        document.getElementById('jobForm').addEventListener('submit', function(event) {
            // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç­‰ã®å‡¦ç†ã‚’ã“ã“ã«è¿½åŠ ã§ãã¾ã™
            console.log('ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¾ã™');
        });
    </script>
</body>
</html>
